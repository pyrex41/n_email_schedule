{
  "calculateScheduledEmails": {
    "defined_in": "src/scheduler.nim",
    "line": 205,
    "callable_from_async": true,
    "returns": "Result[seq[Email]]",
    "calls": [
      "getExclusionWindow",
      "getStateRule",
      "isInExclusionWindow",
      "getYearlyDate",
      "scheduleEmail"
    ],
    "called_by": [
      "calculateScheduledEmailsAsync",
      "calculateBatchScheduledEmails",
      "runScheduler"
    ],
    "purpose": "Calculate scheduled emails for a single contact",
    "error_handling": "Returns Result[seq[Email]] with error message and code",
    "performance_characteristics": "CPU-bound, synchronous"
  },
  "calculateScheduledEmailsAsync": {
    "defined_in": "src/scheduler.nim",
    "line": 861,
    "callable_from_async": true,
    "returns": "Future[Result[seq[Email]]]",
    "calls": [
      "calculateScheduledEmails"
    ],
    "called_by": [
      "calculateBatchScheduledEmailsAsync",
      "api.nim:getScheduledEmails"
    ],
    "purpose": "Asynchronous wrapper for calculateScheduledEmails",
    "error_handling": "Returns Future[Result[seq[Email]]]",
    "performance_characteristics": "Async wrapper, same as calculateScheduledEmails"
  },
  "calculateBatchScheduledEmailsAsync": {
    "defined_in": "src/scheduler.nim",
    "line": 1146,
    "callable_from_async": true,
    "returns": "Future[Result[seq[seq[Email]]]]",
    "calls": [
      "calculateScheduledEmailsAsync",
      "getExclusionWindow",
      "getAepWeekDate",
      "isInExclusionWindow",
      "getStateRule"
    ],
    "called_by": [
      "runScheduler"
    ],
    "purpose": "Calculate scheduled emails for multiple contacts in parallel",
    "error_handling": "Returns Future[Result[seq[seq[Email]]]]",
    "performance_characteristics": "Parallelized, concurrent execution"
  },
  "getConnection": {
    "defined_in": "src/database.nim",
    "callable_from_async": true,
    "returns": "Future[Result[DbConn]]",
    "calls": [],
    "called_by": [
      "getContacts",
      "getContactsBatch",
      "saveEmail",
      "saveEmailsBatch"
    ],
    "purpose": "Get a database connection from the connection pool",
    "error_handling": "Returns Result with error message",
    "performance_characteristics": "I/O bound, connection pooling"
  },
  "getContacts": {
    "defined_in": "src/database.nim",
    "callable_from_async": true,
    "returns": "Future[Result[seq[Contact]]]",
    "calls": [
      "getConnection",
      "releaseConnection"
    ],
    "called_by": [
      "runScheduler",
      "api.nim:getContacts"
    ],
    "purpose": "Retrieve all contacts from the database",
    "error_handling": "Returns Result with error message",
    "performance_characteristics": "I/O bound, sequential"
  },
  "getContactsBatch": {
    "defined_in": "src/database.nim",
    "callable_from_async": true,
    "returns": "Future[Result[seq[Contact]]]",
    "calls": [
      "getConnection",
      "releaseConnection"
    ],
    "called_by": [
      "api.nim:getContactsBatch"
    ],
    "purpose": "Retrieve a batch of contacts from the database",
    "error_handling": "Returns Result with error message",
    "performance_characteristics": "I/O bound, batch operation"
  },
  "saveEmail": {
    "defined_in": "src/database.nim",
    "callable_from_async": true,
    "returns": "Future[Result[void]]",
    "calls": [
      "getConnection",
      "releaseConnection"
    ],
    "called_by": [
      "runScheduler"
    ],
    "purpose": "Save a single email to the database",
    "error_handling": "Returns Result with error message",
    "performance_characteristics": "I/O bound, sequential"
  },
  "saveEmailsBatch": {
    "defined_in": "src/database.nim",
    "callable_from_async": true,
    "returns": "Future[Result[void]]",
    "calls": [
      "getConnection",
      "releaseConnection"
    ],
    "called_by": [
      "runScheduler"
    ],
    "purpose": "Save multiple emails to the database in one operation",
    "error_handling": "Returns Result with error message",
    "performance_characteristics": "I/O bound, batch operation"
  },
  "runScheduler": {
    "defined_in": "src/n_email_schedule.nim",
    "line": 167,
    "callable_from_async": true,
    "returns": "Future[void]",
    "calls": [
      "getContacts",
      "calculateBatchScheduledEmailsAsync",
      "calculateScheduledEmails",
      "saveEmailsBatch",
      "saveEmail"
    ],
    "called_by": [
      "main"
    ],
    "purpose": "Main scheduler function that processes contacts and schedules emails",
    "error_handling": "Logs errors and continues with fallbacks",
    "performance_characteristics": "Orchestration, mixed I/O and CPU"
  }
}